<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>MsSql CSharp Example SI File</title>
</head>
<body>
<h1>MsSql CSharp Example SI File</h1>
<pre>DATABASE AnyDB FLAGS "mssql storedprocs"<br>PACKAGE  Kam.DBRoutines<br>OUTPUT   kopaCodes<br>SERVER   Kopa<br><br>TABLE kopaCodes           ** List of availble Kopa Series Codes<br>  ecoCode       char 24   ** The Normalised Economic Time Series Code<br>  setId         char 2    ** The two character selector code<br>  kopaCode      char 24   ** The Kopa code used for time series<br>  pageId        char 24   ** They seem to have page type selection <br>  period        char      ** D=Daily W=Weekly M=Monthly Q=Quarterly A=Annually S=SemiAnnually<br>  description   char 250  ** Qualifying Description of Series<br>  <a
 href="MCDemoCS.html#SelectedOrd">selected</a>      int       (No=0 Yes=1)<br>  <a
 href="MCDemoCS.html#StrategyOrd">strategy</a>      int       (L'Update'=0 Replace=1 TakeOn=2)<br>  <a
 href="MCDemoCS.html#DisUsedOrd">disUsed</a>       int       (InUse=0 NotInUse=1)<br>  updBy         char 16   <br>  updWhen       timestamp<br><br>KEY kopaCodesPK PRIMARY<br>  ecoCode<br><br>KEY kopaCodesUK UNIQUE<br>  setId<br>  kopaCode<br><br>PROC Insert<br>PROC SelectOne<br>PROC Update<br>PROC DeleteOne<br>PROC SelectAll<br><br>PROC List<br>INPUT<br>  setId           char 2    ** The two character selector code<br>  period          char      ** D=Daily W=Weekly M=Monthly Q=Quarterly S=SemiAnnually A=Annually <br>OUTPUT<br>  ecoCode         char 24   ** The Normalised Economic Time Series Code<br>  pageId          char 24   ** They seem to have page type selection <br>  kopaCode        char 24   ** The code used for time series<br>  period          char      ** D=Daily W=Weekly M=Monthly Q=Quarterly S=SemiAnnually A=Annually <br>  description     char 250  ** Qualifying Description of Series<br>  disUsed         int       <br>SQLCODE<br>  SELECT ecoCode, pageId, kopaCode, period, description, disUsed<br>  FROM kopaCodes<br>  WHERE setId = :setId<br>  AND   period = :period<br>  ORDER BY kopaCode<br>ENDCODE<br><br>PROC ListBySet<br>INPUT<br>  setId         char 2    ** The two character selector code<br>  pageId        char 24   ** They seem to have page type selection <br>  period        char      ** D=Daily W=Weekly M=Monthly Q=Quarterly A=Annually S=???<br>OUTPUT<br>  ecoCode       char 24   ** The code used for time series<br>  selected      int       <br>  strategy      int       <br>  disUsed       int       <br>  description   char 250  ** Qualifying Description of Series<br>  setId         char 2    ** The two character selector code<br>  kopaCode      char 24   ** The code used for time series<br>  pageId        char 24   ** They seem to have page type selection <br>  period        char      ** D=Daily W=Weekly M=Monthly Q=Quarterly A=Annually S=???<br>  updBy         char 16   <br>  updWhen       timestamp<br>SQLCODE<br>  SELECT ecoCode, selected, strategy, disUsed, description, setId, kopaCode, pageId, period, updBy, updWhen<br>  FROM kopaCodes<br>  WHERE setId = :setId<br>  AND  pageId = :pageId<br>  AND  period = :period<br>  ORDER BY ecoCode<br>ENDCODE<br><br>PROC UpdateFromK<br>INPUT<br>  setId           char 2    ** The two character selector code<br>  pageId          char 24   ** They seem to have page type selection <br>  kopaCode        char 24   ** The code used for time series<br>  description     char 250  ** Qualifying Description of Series<br>  updBy           char 16   <br>  updWhen         timestamp<br>SQLCODE<br>  UPDATE kopaCodes <br>  SET pageId = :pageId<br>    , description = :description<br>	, disUsed = 0<br>  WHERE setId = :setId<br>  AND   kopaCode = :kopaCode<br>ENDCODE<br><br>PROC MarkNotUsed<br>INPUT<br>  setId           char 2    ** The two character selector code<br>  kopaCode        char 24   ** The code used for time series<br>SQLCODE<br>  UPDATE kopaCodes <br>  SET disUsed = 1<br>  WHERE setId = :setId<br>  AND   kopaCode = :kopaCode<br>ENDCODE<br><br>PROC UpdateSelect<br>INPUT<br>  setId         char 2    ** The two character selector code<br>  kopaCode      char 24   ** The Kopa code used for time series<br>  ecoCode       char 24   ** The normalised code used for time series<br>  selected      int       <br>  strategy      int       <br>SQLCODE<br>  UPDATE kopaCodes <br>  SET ecoCode  = :ecoCode<br>    , selected = :selected<br>    , strategy = :strategy<br>  WHERE setId  = :setId<br>  AND kopaCode = :kopaCode<br>ENDCODE<br><br>PROC BuildSetList<br>INPUT<br>  setId         char 2    ** The two character selector code<br>OUTPUT<br>  ecoCode       char 24   ** The normalised code used for time series<br>  selected      int       <br>  strategy      int       <br>  dir           char 16   ** Directory on CD where the Data is found<br>  setId         char 2    ** The two character selector code<br>  kopaCode      char 24   ** The Kopa code used for time series<br>  period        char      ** Period for update<br>  lastNo        integer   ** Set no to be used for update<br>SQLCODE<br>  SELECT c.ecoCode, c.selected, c.strategy, s.dir, c.setId, c.kopaCode, c.period, s.lastNo<br>  FROM kopaCodes c, KopaSets s<br>  WHERE c.selected &gt; 0<br>  AND   (s.setId = :setId or :setId = '**')<br>  AND   c.setId = s.SetId<br>ENDCODE<br><br>PROC ChangeAlias<br>INPUT<br>  setId         char 2    ** The two character selector code<br>  kopaCode      char 24   ** The Kopa code used for time series<br>  ecoCode       char 24   ** This code is unique here and will be unique if present in kopaCodes on JohnnyDB<br>SQLCODE<br>  update kopaCodes set ecoCode = :ecoCode <br>  where  setId = :setId <br>  and    kopaCode = :kopaCode<br>ENDCODE<br></pre>
</body>
</html>
