<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>MsSql CSharp Example CS File</title>
</head>
<body>
<h1>MsSQL CSharp Example CS File</h1>
<pre>using System;<br>using System.Collections;<br>using System.Data;<br>using Kam.DBRoutines;<br><br>namespace Kam.DBRoutines<br>{<br>  ///  List of available Kopa Series Codes<br>  <br>  [Serializable()]<br>  public class kopaCodesRec<br>  {<br>    public string ecoCode;<br>    public string setId;<br>    public string kopaCode;<br>    public string pageId;<br>    public string period;<br>    public string description;<br>    public int selected;<br>    public int strategy;<br>    public int disUsed;<br>    public string updBy;<br>    public DateTime updWhen;<br>  }<br>  <br><a
 name="SelectedOrd">public class kopaCodesSelectedOrd</a><br>  {<br>    public const int No = 0;<br>    public const int Yes = 1;<br>    public static string ToString(int ordinal)<br>    {<br>      switch (ordinal)<br>      {<br>      case 0: return "No";<br>      case 1: return "Yes";<br>      }<br>      return "";<br>    }<br>  }<br>  <a
 name="StrategyOrd">public class kopaCodesStrategyOrd</a><br>  {<br>    public const int Update = 0;<br>    public const int Replace = 1;<br>    public const int TakeOn = 2;<br>    public static string ToString(int ordinal)<br>    {<br>      switch (ordinal)<br>      {<br>      case 0: return "Update";<br>      case 1: return "Replace";<br>      case 2: return "TakeOn";<br>      }<br>      return "";<br>    }<br>  }<br>  <a
 name="DisUsedOrd">public class kopaCodesDisUsedOrd</a><br>  {<br>    public const int InUse = 0;<br>    public const int NotInUse = 1;<br>    public static string ToString(int ordinal)<br>    {<br>      switch (ordinal)<br>      {<br>      case 0: return "InUse";<br>      case 1: return "NotInUse";<br>      }<br>      return "";<br>    }<br>  }<br>  [Serializable()]<br>  public class kopaCodesDeleteOneRec<br>  {<br>    public string ecoCode;<br>  }<br>  [Serializable()]<br>  public class kopaCodesListRec<br>  {<br>    public string ecoCode;<br>    public string pageId;<br>    public string kopaCode;<br>    public string period;<br>    public string description;<br>    public int disUsed;<br>    public string setId;<br>  }<br>  [Serializable()]<br>  public class kopaCodesListBySetRec<br>  {<br>    public string ecoCode;<br>    public int selected;<br>    public int strategy;<br>    public int disUsed;<br>    public string description;<br>    public string setId;<br>    public string kopaCode;<br>    public string pageId;<br>    public string period;<br>    public string updBy;<br>    public DateTime updWhen;<br>  }<br>  [Serializable()]<br>  public class kopaCodesUpdateFromKRec<br>  {<br>    public string setId;<br>    public string pageId;<br>    public string kopaCode;<br>    public string description;<br>    public string updBy;<br>    public DateTime updWhen;<br>  }<br>  [Serializable()]<br>  public class kopaCodesMarkNotUsedRec<br>  {<br>    public string setId;<br>    public string kopaCode;<br>  }<br>  [Serializable()]<br>  public class kopaCodesUpdateSelectRec<br>  {<br>    public string setId;<br>    public string kopaCode;<br>    public string ecoCode;<br>    public int selected;<br>    public int strategy;<br>  }<br>  [Serializable()]<br>  public class kopaCodesBuildSetListRec<br>  {<br>    public string ecoCode;<br>    public int selected;<br>    public int strategy;<br>    public string dir;<br>    public string setId;<br>    public string kopaCode;<br>    public string period;<br>    public int lastNo;<br>  }<br>  [Serializable()]<br>  public class kopaCodesChangeAliasRec<br>  {<br>    public string setId;<br>    public string kopaCode;<br>    public string ecoCode;<br>  }<br>  public class kopaCodesSelectAllDataTable : DataTable<br>  {<br>    public const int cEcoCode = 0;<br>    public const int cSetId = 1;<br>    public const int cKopaCode = 2;<br>    public const int cPageId = 3;<br>    public const int cPeriod = 4;<br>    public const int cDescription = 5;<br>    public const int cSelected = 6;<br>    public const int cStrategy = 7;<br>    public const int cDisUsed = 8;<br>    public const int cUpdBy = 9;<br>    public const int cUpdWhen = 10;<br>    public static string ToString(int ordinal)<br>    {<br>      switch (ordinal)<br>      {<br>      case cEcoCode: return "EcoCode";<br>      case cSetId: return "SetId";<br>      case cKopaCode: return "KopaCode";<br>      case cPageId: return "PageId";<br>      case cPeriod: return "Period";<br>      case cDescription: return "Description";<br>      case cSelected: return "Selected";<br>      case cStrategy: return "Strategy";<br>      case cDisUsed: return "DisUsed";<br>      case cUpdBy: return "UpdBy";<br>      case cUpdWhen: return "UpdWhen";<br>      }<br>      return "";<br>    }<br>    public kopaCodesSelectAllDataTable(ArrayList aList)<br>    : base("kopaCodesSelectAll")<br>    {<br>      Columns.Add(new DataColumn("EcoCode", typeof(String)));<br>      Columns.Add(new DataColumn("SetId", typeof(String)));<br>      Columns.Add(new DataColumn("KopaCode", typeof(String)));<br>      Columns.Add(new DataColumn("PageId", typeof(String)));<br>      Columns.Add(new DataColumn("Period", typeof(String)));<br>      Columns.Add(new DataColumn("Description", typeof(String)));<br>      Columns.Add(new DataColumn("Selected", typeof(Int32)));<br>      Columns.Add(new DataColumn("Strategy", typeof(Int32)));<br>      Columns.Add(new DataColumn("DisUsed", typeof(Int32)));<br>      Columns.Add(new DataColumn("UpdBy", typeof(String)));<br>      Columns.Add(new DataColumn("UpdWhen", typeof(String)));<br>      foreach (kopaCodesRec wRec in aList)<br>      {<br>        DataRow wRow = NewRow();<br>        wRow[cEcoCode] = wRec.ecoCode;<br>        wRow[cSetId] = wRec.setId;<br>        wRow[cKopaCode] = wRec.kopaCode;<br>        wRow[cPageId] = wRec.pageId;<br>        wRow[cPeriod] = wRec.period;<br>        wRow[cDescription] = wRec.description;<br>        wRow[cSelected] = wRec.selected;<br>        wRow[cStrategy] = wRec.strategy;<br>        wRow[cDisUsed] = wRec.disUsed;<br>        wRow[cUpdBy] = wRec.updBy;<br>        wRow[cUpdWhen] = wRec.updWhen;<br>        Rows.Add(wRow);<br>      }<br>    }<br>    public kopaCodesRec this[int row]<br>    {<br>      get<br>      {<br>        DataRow wRow = Rows[row];<br>        kopaCodesRec wRec = new kopaCodesRec();<br>        wRec.ecoCode = (string)wRow[cEcoCode];<br>        wRec.setId = (string)wRow[cSetId];<br>        wRec.kopaCode = (string)wRow[cKopaCode];<br>        wRec.pageId = (string)wRow[cPageId];<br>        wRec.period = (string)wRow[cPeriod];<br>        wRec.description = (string)wRow[cDescription];<br>        wRec.selected = (int)wRow[cSelected];<br>        wRec.strategy = (int)wRow[cStrategy];<br>        wRec.disUsed = (int)wRow[cDisUsed];<br>        wRec.updBy = (string)wRow[cUpdBy];<br>        wRec.updWhen = (DateTime)wRow[cUpdWhen];<br>        return wRec;<br>      }<br>      set<br>      {<br>        DataRow wRow = Rows[row];<br>        wRow[cEcoCode] = value.ecoCode;<br>        wRow[cSetId] = value.setId;<br>        wRow[cKopaCode] = value.kopaCode;<br>        wRow[cPageId] = value.pageId;<br>        wRow[cPeriod] = value.period;<br>        wRow[cDescription] = value.description;<br>        wRow[cSelected] = value.selected;<br>        wRow[cStrategy] = value.strategy;<br>        wRow[cDisUsed] = value.disUsed;<br>        wRow[cUpdBy] = value.updBy;<br>        wRow[cUpdWhen] = value.updWhen;<br>      }<br>    }<br>  }<br>  public class kopaCodesListDataTable : DataTable<br>  {<br>    public const int cSetId = 0;<br>    public const int cPeriod = 1;<br>    public const int cEcoCode = 2;<br>    public const int cPageId = 3;<br>    public const int cKopaCode = 4;<br>    public const int cDescription = 5;<br>    public const int cDisUsed = 6;<br>    public static string ToString(int ordinal)<br>    {<br>      switch (ordinal)<br>      {<br>      case cSetId: return "SetId";<br>      case cPeriod: return "Period";<br>      case cEcoCode: return "EcoCode";<br>      case cPageId: return "PageId";<br>      case cKopaCode: return "KopaCode";<br>      case cDescription: return "Description";<br>      case cDisUsed: return "DisUsed";<br>      }<br>      return "";<br>    }<br>    public kopaCodesListDataTable(ArrayList aList)<br>    : base("kopaCodesList")<br>    {<br>      Columns.Add(new DataColumn("SetId", typeof(String)));<br>      Columns.Add(new DataColumn("Period", typeof(String)));<br>      Columns.Add(new DataColumn("EcoCode", typeof(String)));<br>      Columns.Add(new DataColumn("PageId", typeof(String)));<br>      Columns.Add(new DataColumn("KopaCode", typeof(String)));<br>      Columns.Add(new DataColumn("Description", typeof(String)));<br>      Columns.Add(new DataColumn("DisUsed", typeof(Int32)));<br>      foreach (kopaCodesListRec wRec in aList)<br>      {<br>        DataRow wRow = NewRow();<br>        wRow[cSetId] = wRec.setId;<br>        wRow[cPeriod] = wRec.period;<br>        wRow[cEcoCode] = wRec.ecoCode;<br>        wRow[cPageId] = wRec.pageId;<br>        wRow[cKopaCode] = wRec.kopaCode;<br>        wRow[cDescription] = wRec.description;<br>        wRow[cDisUsed] = wRec.disUsed;<br>        Rows.Add(wRow);<br>      }<br>    }<br>    public kopaCodesListRec this[int row]<br>    {<br>      get<br>      {<br>        DataRow wRow = Rows[row];<br>        kopaCodesListRec wRec = new kopaCodesListRec();<br>        wRec.setId = (string)wRow[cSetId];<br>        wRec.period = (string)wRow[cPeriod];<br>        wRec.ecoCode = (string)wRow[cEcoCode];<br>        wRec.pageId = (string)wRow[cPageId];<br>        wRec.kopaCode = (string)wRow[cKopaCode];<br>        wRec.description = (string)wRow[cDescription];<br>        wRec.disUsed = (int)wRow[cDisUsed];<br>        return wRec;<br>      }<br>      set<br>      {<br>        DataRow wRow = Rows[row];<br>        wRow[cSetId] = value.setId;<br>        wRow[cPeriod] = value.period;<br>        wRow[cEcoCode] = value.ecoCode;<br>        wRow[cPageId] = value.pageId;<br>        wRow[cKopaCode] = value.kopaCode;<br>        wRow[cDescription] = value.description;<br>        wRow[cDisUsed] = value.disUsed;<br>      }<br>    }<br>  }<br>  public class kopaCodesListBySetDataTable : DataTable<br>  {<br>    public const int cSetId = 0;<br>    public const int cPageId = 1;<br>    public const int cPeriod = 2;<br>    public const int cEcoCode = 3;<br>    public const int cSelected = 4;<br>    public const int cStrategy = 5;<br>    public const int cDisUsed = 6;<br>    public const int cDescription = 7;<br>    public const int cKopaCode = 8;<br>    public const int cUpdBy = 9;<br>    public const int cUpdWhen = 10;<br>    public static string ToString(int ordinal)<br>    {<br>      switch (ordinal)<br>      {<br>      case cSetId: return "SetId";<br>      case cPageId: return "PageId";<br>      case cPeriod: return "Period";<br>      case cEcoCode: return "EcoCode";<br>      case cSelected: return "Selected";<br>      case cStrategy: return "Strategy";<br>      case cDisUsed: return "DisUsed";<br>      case cDescription: return "Description";<br>      case cKopaCode: return "KopaCode";<br>      case cUpdBy: return "UpdBy";<br>      case cUpdWhen: return "UpdWhen";<br>      }<br>      return "";<br>    }<br>    public kopaCodesListBySetDataTable(ArrayList aList)<br>    : base("kopaCodesListBySet")<br>    {<br>      Columns.Add(new DataColumn("SetId", typeof(String)));<br>      Columns.Add(new DataColumn("PageId", typeof(String)));<br>      Columns.Add(new DataColumn("Period", typeof(String)));<br>      Columns.Add(new DataColumn("EcoCode", typeof(String)));<br>      Columns.Add(new DataColumn("Selected", typeof(Int32)));<br>      Columns.Add(new DataColumn("Strategy", typeof(Int32)));<br>      Columns.Add(new DataColumn("DisUsed", typeof(Int32)));<br>      Columns.Add(new DataColumn("Description", typeof(String)));<br>      Columns.Add(new DataColumn("KopaCode", typeof(String)));<br>      Columns.Add(new DataColumn("UpdBy", typeof(String)));<br>      Columns.Add(new DataColumn("UpdWhen", typeof(String)));<br>      foreach (kopaCodesListBySetRec wRec in aList)<br>      {<br>        DataRow wRow = NewRow();<br>        wRow[cSetId] = wRec.setId;<br>        wRow[cPageId] = wRec.pageId;<br>        wRow[cPeriod] = wRec.period;<br>        wRow[cEcoCode] = wRec.ecoCode;<br>        wRow[cSelected] = wRec.selected;<br>        wRow[cStrategy] = wRec.strategy;<br>        wRow[cDisUsed] = wRec.disUsed;<br>        wRow[cDescription] = wRec.description;<br>        wRow[cKopaCode] = wRec.kopaCode;<br>        wRow[cUpdBy] = wRec.updBy;<br>        wRow[cUpdWhen] = wRec.updWhen;<br>        Rows.Add(wRow);<br>      }<br>    }<br>    public kopaCodesListBySetRec this[int row]<br>    {<br>      get<br>      {<br>        DataRow wRow = Rows[row];<br>        kopaCodesListBySetRec wRec = new kopaCodesListBySetRec();<br>        wRec.setId = (string)wRow[cSetId];<br>        wRec.pageId = (string)wRow[cPageId];<br>        wRec.period = (string)wRow[cPeriod];<br>        wRec.ecoCode = (string)wRow[cEcoCode];<br>        wRec.selected = (int)wRow[cSelected];<br>        wRec.strategy = (int)wRow[cStrategy];<br>        wRec.disUsed = (int)wRow[cDisUsed];<br>        wRec.description = (string)wRow[cDescription];<br>        wRec.kopaCode = (string)wRow[cKopaCode];<br>        wRec.updBy = (string)wRow[cUpdBy];<br>        wRec.updWhen = (DateTime)wRow[cUpdWhen];<br>        return wRec;<br>      }<br>      set<br>      {<br>        DataRow wRow = Rows[row];<br>        wRow[cSetId] = value.setId;<br>        wRow[cPageId] = value.pageId;<br>        wRow[cPeriod] = value.period;<br>        wRow[cEcoCode] = value.ecoCode;<br>        wRow[cSelected] = value.selected;<br>        wRow[cStrategy] = value.strategy;<br>        wRow[cDisUsed] = value.disUsed;<br>        wRow[cDescription] = value.description;<br>        wRow[cKopaCode] = value.kopaCode;<br>        wRow[cUpdBy] = value.updBy;<br>        wRow[cUpdWhen] = value.updWhen;<br>      }<br>    }<br>  }<br>  public class kopaCodesBuildSetListDataTable : DataTable<br>  {<br>    public const int cSetId = 0;<br>    public const int cEcoCode = 1;<br>    public const int cSelected = 2;<br>    public const int cStrategy = 3;<br>    public const int cDir = 4;<br>    public const int cKopaCode = 5;<br>    public const int cPeriod = 6;<br>    public const int cLastNo = 7;<br>    public static string ToString(int ordinal)<br>    {<br>      switch (ordinal)<br>      {<br>      case cSetId: return "SetId";<br>      case cEcoCode: return "EcoCode";<br>      case cSelected: return "Selected";<br>      case cStrategy: return "Strategy";<br>      case cDir: return "Dir";<br>      case cKopaCode: return "KopaCode";<br>      case cPeriod: return "Period";<br>      case cLastNo: return "LastNo";<br>      }<br>      return "";<br>    }<br>    public kopaCodesBuildSetListDataTable(ArrayList aList)<br>    : base("kopaCodesBuildSetList")<br>    {<br>      Columns.Add(new DataColumn("SetId", typeof(String)));<br>      Columns.Add(new DataColumn("EcoCode", typeof(String)));<br>      Columns.Add(new DataColumn("Selected", typeof(Int32)));<br>      Columns.Add(new DataColumn("Strategy", typeof(Int32)));<br>      Columns.Add(new DataColumn("Dir", typeof(String)));<br>      Columns.Add(new DataColumn("KopaCode", typeof(String)));<br>      Columns.Add(new DataColumn("Period", typeof(String)));<br>      Columns.Add(new DataColumn("LastNo", typeof(Int32)));<br>      foreach (kopaCodesBuildSetListRec wRec in aList)<br>      {<br>        DataRow wRow = NewRow();<br>        wRow[cSetId] = wRec.setId;<br>        wRow[cEcoCode] = wRec.ecoCode;<br>        wRow[cSelected] = wRec.selected;<br>        wRow[cStrategy] = wRec.strategy;<br>        wRow[cDir] = wRec.dir;<br>        wRow[cKopaCode] = wRec.kopaCode;<br>        wRow[cPeriod] = wRec.period;<br>        wRow[cLastNo] = wRec.lastNo;<br>        Rows.Add(wRow);<br>      }<br>    }<br>    public kopaCodesBuildSetListRec this[int row]<br>    {<br>      get<br>      {<br>        DataRow wRow = Rows[row];<br>        kopaCodesBuildSetListRec wRec = new kopaCodesBuildSetListRec();<br>        wRec.setId = (string)wRow[cSetId];<br>        wRec.ecoCode = (string)wRow[cEcoCode];<br>        wRec.selected = (int)wRow[cSelected];<br>        wRec.strategy = (int)wRow[cStrategy];<br>        wRec.dir = (string)wRow[cDir];<br>        wRec.kopaCode = (string)wRow[cKopaCode];<br>        wRec.period = (string)wRow[cPeriod];<br>        wRec.lastNo = (int)wRow[cLastNo];<br>        return wRec;<br>      }<br>      set<br>      {<br>        DataRow wRow = Rows[row];<br>        wRow[cSetId] = value.setId;<br>        wRow[cEcoCode] = value.ecoCode;<br>        wRow[cSelected] = value.selected;<br>        wRow[cStrategy] = value.strategy;<br>        wRow[cDir] = value.dir;<br>        wRow[cKopaCode] = value.kopaCode;<br>        wRow[cPeriod] = value.period;<br>        wRow[cLastNo] = value.lastNo;<br>      }<br>    }<br>  }<br>  [Serializable()]<br>  public class kopaCodes<br>  {<br>    private kopaCodesRec mRec;<br>    public kopaCodesRec Rec { get { return mRec; } set { mRec = value; } }<br>    private ArrayList mList;<br>    public int Count { get { return mList.Count; } }<br>    public Cursor mCursor;<br>    public kopaCodesRec this[int i]<br>    {<br>      get<br>      {<br>        if (i &lt; mList.Count)<br>          return (kopaCodesRec)mList[i];<br>        return null;<br>      }<br>      set<br>      {<br>        if (i &lt; mList.Count)<br>          mList.RemoveAt(i);<br>        mList.Insert(i, value);<br>      }<br>    }<br>    public void Clear()<br>    {<br>      mList = new ArrayList();<br>      mRec = new kopaCodesRec();<br>    }<br>    public kopaCodes()<br>    {<br>      Clear();<br>    }<br>    public string CommandInsert<br>    {<br>      // insert into kopaCodes<br>      // ( ecoCode<br>      // , setId<br>      // , kopaCode<br>      // , pageId<br>      // , period<br>      // , description<br>      // , selected<br>      // , strategy<br>      // , disUsed<br>      // , updBy<br>      // , updWhen<br>      // ) <br>      // values<br>      //  (@P0<br>      // , @P1<br>      // , @P2<br>      // , @P3<br>      // , @P4<br>      // , @P5<br>      // , @P6<br>      // , @P7<br>      // , @P8<br>      // , @P9<br>      // , @P10<br>      // )<br>      get {return "kopaCodesInsert";}<br>    }<br>    public void Insert(Connect aConnect)<br>    {<br>      Cursor wCursor = new Cursor(aConnect);<br>      wCursor.Procedure(CommandInsert);<br>      wCursor.Parameter(0, mRec.ecoCode);<br>      wCursor.Parameter(1, mRec.setId);<br>      wCursor.Parameter(2, mRec.kopaCode);<br>      wCursor.Parameter(3, mRec.pageId);<br>      wCursor.Parameter(4, mRec.period);<br>      wCursor.Parameter(5, mRec.description);<br>      wCursor.Parameter(6, mRec.selected);<br>      wCursor.Parameter(7, mRec.strategy);<br>      wCursor.Parameter(8, mRec.disUsed);<br>      wCursor.Parameter(9, mRec.updBy);<br>      wCursor.Parameter(10, mRec.updWhen);<br>      wCursor.Exec();<br>    }<br>    public string CommandSelectOne<br>    {<br>      // select<br>      //   setId<br>      // , kopaCode<br>      // , pageId<br>      // , period<br>      // , description<br>      // , selected<br>      // , strategy<br>      // , disUsed<br>      // , updBy<br>      // , updWhen<br>      //  from kopaCodes<br>      //  where ecoCode = @P0<br>      get {return "kopaCodesSelectOne";}<br>    }<br>    public bool SelectOne(Connect aConnect)<br>    {<br>      Cursor wCursor = new Cursor(aConnect);<br>      wCursor.Procedure(CommandSelectOne);<br>      wCursor.Parameter(0, mRec.ecoCode);<br>      wCursor.Run();<br>      bool wResult = (wCursor.HasReader() &amp;&amp; wCursor.Read());<br>      if (wResult == true)<br>      {<br>        mRec.setId = wCursor.GetString(0);<br>        mRec.kopaCode = wCursor.GetString(1);<br>        mRec.pageId = wCursor.GetString(2);<br>        mRec.period = wCursor.GetString(3);<br>        mRec.description = wCursor.GetString(4);<br>        mRec.selected = wCursor.GetInt(5);<br>        mRec.strategy = wCursor.GetInt(6);<br>        mRec.disUsed = wCursor.GetInt(7);<br>        mRec.updBy = wCursor.GetString(8);<br>        mRec.updWhen = wCursor.GetDateTime(9);<br>      }<br>      if (wCursor.HasReader())<br>        wCursor.Close();<br>      return wResult;<br>    }<br>    public string CommandUpdate<br>    {<br>      // update kopaCodes<br>      //  set<br>      //   setId = @P0<br>      // , kopaCode = @P1<br>      // , pageId = @P2<br>      // , period = @P3<br>      // , description = @P4<br>      // , selected = @P5<br>      // , strategy = @P6<br>      // , disUsed = @P7<br>      // , updBy = @P8<br>      // , updWhen = @P9<br>      //  where ecoCode = @P10<br>      get {return "kopaCodesUpdate";}<br>    }<br>    public void Update(Connect aConnect)<br>    {<br>      Cursor wCursor = new Cursor(aConnect);<br>      wCursor.Procedure(CommandUpdate);<br>      wCursor.Parameter(0, mRec.setId);<br>      wCursor.Parameter(1, mRec.kopaCode);<br>      wCursor.Parameter(2, mRec.pageId);<br>      wCursor.Parameter(3, mRec.period);<br>      wCursor.Parameter(4, mRec.description);<br>      wCursor.Parameter(5, mRec.selected);<br>      wCursor.Parameter(6, mRec.strategy);<br>      wCursor.Parameter(7, mRec.disUsed);<br>      wCursor.Parameter(8, mRec.updBy);<br>      wCursor.Parameter(9, mRec.updWhen);<br>      wCursor.Parameter(10, mRec.ecoCode);<br>      wCursor.Exec();<br>    }<br>    public string CommandSelectAll<br>    {<br>      // select<br>      //   ecoCode<br>      // , setId<br>      // , kopaCode<br>      // , pageId<br>      // , period<br>      // , description<br>      // , selected<br>      // , strategy<br>      // , disUsed<br>      // , updBy<br>      // , updWhen<br>      //  from kopaCodes<br>      get {return "kopaCodesSelectAll";}<br>    }<br>    public void SelectAll(Connect aConnect)<br>    {<br>      mCursor = new Cursor(aConnect);<br>      mCursor.Procedure(CommandSelectAll);<br>      mCursor.Run();<br>    }<br>    public bool SelectAllFetch()<br>    {<br>      bool wResult = (mCursor.HasReader() &amp;&amp; mCursor.Read());<br>      if (wResult == true)<br>      {<br>        mRec.ecoCode = mCursor.GetString(0);<br>        mRec.setId = mCursor.GetString(1);<br>        mRec.kopaCode = mCursor.GetString(2);<br>        mRec.pageId = mCursor.GetString(3);<br>        mRec.period = mCursor.GetString(4);<br>        mRec.description = mCursor.GetString(5);<br>        mRec.selected = mCursor.GetInt(6);<br>        mRec.strategy = mCursor.GetInt(7);<br>        mRec.disUsed = mCursor.GetInt(8);<br>        mRec.updBy = mCursor.GetString(9);<br>        mRec.updWhen = mCursor.GetDateTime(10);<br>      }<br>      else if (mCursor.HasReader())<br>        mCursor.Close();<br>      return wResult;<br>    }<br>    public void SelectAllLoad(Connect aConnect)<br>    {<br>      SelectAll(aConnect);<br>      while (SelectAllFetch())<br>      {<br>        mList.Add(mRec);<br>        mRec = new kopaCodesRec();<br>      }<br>    }<br>    public ArrayList Loaded { get { return mList; } }<br>    public class SelectAllOrd<br>    {<br>      public const int ecoCode = 0;<br>      public const int setId = 1;<br>      public const int kopaCode = 2;<br>      public const int pageId = 3;<br>      public const int period = 4;<br>      public const int description = 5;<br>      public const int selected = 6;<br>      public const int strategy = 7;<br>      public const int disUsed = 8;<br>      public const int updBy = 9;<br>      public const int updWhen = 10;<br>      public static string ToString(int ordinal)<br>      {<br>        switch (ordinal)<br>        {<br>        case 0: return "ecoCode";<br>        case 1: return "setId";<br>        case 2: return "kopaCode";<br>        case 3: return "pageId";<br>        case 4: return "period";<br>        case 5: return "description";<br>        case 6: return "selected";<br>        case 7: return "strategy";<br>        case 8: return "disUsed";<br>        case 9: return "updBy";<br>        case 10: return "updWhen";<br>        }<br>        return "";<br>      }<br>    }<br>    public kopaCodesSelectAllDataTable SelectAllDataTable()<br>    {<br>      kopaCodesSelectAllDataTable wResult = new kopaCodesSelectAllDataTable(mList);<br>      return wResult;<br>    }<br>    public kopaCodesSelectAllDataTable SelectAllDataTable(Connect aConnect)<br>    {<br>      SelectAllLoad(aConnect);<br>      return SelectAllDataTable();<br>    }<br>  }<br>  [Serializable()]<br>  public class kopaCodesDeleteOne<br>  {<br>    private kopaCodesDeleteOneRec mRec;<br>    public kopaCodesDeleteOneRec Rec { get { return mRec; } set { mRec = value; } }<br>    public void Clear()<br>    {<br>      mRec = new kopaCodesDeleteOneRec();<br>    }<br>    public kopaCodesDeleteOne()<br>    {<br>      Clear();<br>    }<br>    public string CommandDeleteOne<br>    {<br>      // delete from kopaCodes<br>      //  where ecoCode = @P0<br>      get {return "kopaCodesDeleteOne";}<br>    }<br>    public void DeleteOne(Connect aConnect)<br>    {<br>      Cursor wCursor = new Cursor(aConnect);<br>      wCursor.Procedure(CommandDeleteOne);<br>      wCursor.Parameter(0, mRec.ecoCode);<br>      wCursor.Exec();<br>    }<br>  }<br>  [Serializable()]<br>  public class kopaCodesList<br>  {<br>    private kopaCodesListRec mRec;<br>    public kopaCodesListRec Rec { get { return mRec; } set { mRec = value; } }<br>    private ArrayList mList;<br>    public int Count { get { return mList.Count; } }<br>    public Cursor mCursor;<br>    public kopaCodesListRec this[int i]<br>    {<br>      get<br>      {<br>        if (i &lt; mList.Count)<br>          return (kopaCodesListRec)mList[i];<br>        return null;<br>      }<br>      set<br>      {<br>        if (i &lt; mList.Count)<br>          mList.RemoveAt(i);<br>        mList.Insert(i, value);<br>      }<br>    }<br>    public void Clear()<br>    {<br>      mList = new ArrayList();<br>      mRec = new kopaCodesListRec();<br>    }<br>    public kopaCodesList()<br>    {<br>      Clear();<br>    }<br>    public string CommandList<br>    {<br>      // SELECT ecoCode, pageId, kopaCode, period, description, disUsed <br>      // FROM kopaCodes <br>      // WHERE setId = @P0 <br>      // AND   period = @P1 <br>      // ORDER BY kopaCode <br>      get {return "kopaCodesList";}<br>    }<br>    public void List(Connect aConnect)<br>    {<br>      mCursor = new Cursor(aConnect);<br>      mCursor.Procedure(CommandList);<br>      mCursor.Parameter(0, mRec.setId);<br>      mCursor.Parameter(1, mRec.period);<br>      mCursor.Run();<br>    }<br>    public bool ListFetch()<br>    {<br>      bool wResult = (mCursor.HasReader() &amp;&amp; mCursor.Read());<br>      if (wResult == true)<br>      {<br>        mRec.ecoCode = mCursor.GetString(0);<br>        mRec.pageId = mCursor.GetString(1);<br>        mRec.kopaCode = mCursor.GetString(2);<br>        mRec.period = mCursor.GetString(3);<br>        mRec.description = mCursor.GetString(4);<br>        mRec.disUsed = mCursor.GetInt(5);<br>      }<br>      else if (mCursor.HasReader())<br>        mCursor.Close();<br>      return wResult;<br>    }<br>    public void ListLoad(Connect aConnect)<br>    {<br>      List(aConnect);<br>      while (ListFetch())<br>      {<br>        mList.Add(mRec);<br>        mRec = new kopaCodesListRec();<br>      }<br>    }<br>    public ArrayList Loaded { get { return mList; } }<br>    public class ListOrd<br>    {<br>      public const int setId = 0;<br>      public const int period = 1;<br>      public const int ecoCode = 2;<br>      public const int pageId = 3;<br>      public const int kopaCode = 4;<br>      public const int description = 5;<br>      public const int disUsed = 6;<br>      public static string ToString(int ordinal)<br>      {<br>        switch (ordinal)<br>        {<br>        case 0: return "setId";<br>        case 1: return "period";<br>        case 2: return "ecoCode";<br>        case 3: return "pageId";<br>        case 4: return "kopaCode";<br>        case 5: return "description";<br>        case 6: return "disUsed";<br>        }<br>        return "";<br>      }<br>    }<br>    public kopaCodesListDataTable ListDataTable()<br>    {<br>      kopaCodesListDataTable wResult = new kopaCodesListDataTable(mList);<br>      return wResult;<br>    }<br>    public kopaCodesListDataTable ListDataTable(Connect aConnect)<br>    {<br>      ListLoad(aConnect);<br>      return ListDataTable();<br>    }<br>  }<br>  [Serializable()]<br>  public class kopaCodesListBySet<br>  {<br>    private kopaCodesListBySetRec mRec;<br>    public kopaCodesListBySetRec Rec { get { return mRec; } set { mRec = value; } }<br>    private ArrayList mList;<br>    public int Count { get { return mList.Count; } }<br>    public Cursor mCursor;<br>    public kopaCodesListBySetRec this[int i]<br>    {<br>      get<br>      {<br>        if (i &lt; mList.Count)<br>          return (kopaCodesListBySetRec)mList[i];<br>        return null;<br>      }<br>      set<br>      {<br>        if (i &lt; mList.Count)<br>          mList.RemoveAt(i);<br>        mList.Insert(i, value);<br>      }<br>    }<br>    public void Clear()<br>    {<br>      mList = new ArrayList();<br>      mRec = new kopaCodesListBySetRec();<br>    }<br>    public kopaCodesListBySet()<br>    {<br>      Clear();<br>    }<br>    public string CommandListBySet<br>    {<br>      // SELECT ecoCode, selected, strategy, disUsed, description, setId, kopaCode, pageId, period, updBy, updWhen <br>      // FROM kopaCodes <br>      // WHERE setId = @P0 <br>      // AND  pageId = @P1 <br>      // AND  period = @P2 <br>      // ORDER BY ecoCode <br>      get {return "kopaCodesListBySet";}<br>    }<br>    public void ListBySet(Connect aConnect)<br>    {<br>      mCursor = new Cursor(aConnect);<br>      mCursor.Procedure(CommandListBySet);<br>      mCursor.Parameter(0, mRec.setId);<br>      mCursor.Parameter(1, mRec.pageId);<br>      mCursor.Parameter(2, mRec.period);<br>      mCursor.Run();<br>    }<br>    public bool ListBySetFetch()<br>    {<br>      bool wResult = (mCursor.HasReader() &amp;&amp; mCursor.Read());<br>      if (wResult == true)<br>      {<br>        mRec.ecoCode = mCursor.GetString(0);<br>        mRec.selected = mCursor.GetInt(1);<br>        mRec.strategy = mCursor.GetInt(2);<br>        mRec.disUsed = mCursor.GetInt(3);<br>        mRec.description = mCursor.GetString(4);<br>        mRec.setId = mCursor.GetString(5);<br>        mRec.kopaCode = mCursor.GetString(6);<br>        mRec.pageId = mCursor.GetString(7);<br>        mRec.period = mCursor.GetString(8);<br>        mRec.updBy = mCursor.GetString(9);<br>        mRec.updWhen = mCursor.GetDateTime(10);<br>      }<br>      else if (mCursor.HasReader())<br>        mCursor.Close();<br>      return wResult;<br>    }<br>    public void ListBySetLoad(Connect aConnect)<br>    {<br>      ListBySet(aConnect);<br>      while (ListBySetFetch())<br>      {<br>        mList.Add(mRec);<br>        mRec = new kopaCodesListBySetRec();<br>      }<br>    }<br>    public ArrayList Loaded { get { return mList; } }<br>    public class ListBySetOrd<br>    {<br>      public const int setId = 0;<br>      public const int pageId = 1;<br>      public const int period = 2;<br>      public const int ecoCode = 3;<br>      public const int selected = 4;<br>      public const int strategy = 5;<br>      public const int disUsed = 6;<br>      public const int description = 7;<br>      public const int kopaCode = 8;<br>      public const int updBy = 9;<br>      public const int updWhen = 10;<br>      public static string ToString(int ordinal)<br>      {<br>        switch (ordinal)<br>        {<br>        case 0: return "setId";<br>        case 1: return "pageId";<br>        case 2: return "period";<br>        case 3: return "ecoCode";<br>        case 4: return "selected";<br>        case 5: return "strategy";<br>        case 6: return "disUsed";<br>        case 7: return "description";<br>        case 8: return "kopaCode";<br>        case 9: return "updBy";<br>        case 10: return "updWhen";<br>        }<br>        return "";<br>      }<br>    }<br>    public kopaCodesListBySetDataTable ListBySetDataTable()<br>    {<br>      kopaCodesListBySetDataTable wResult = new kopaCodesListBySetDataTable(mList);<br>      return wResult;<br>    }<br>    public kopaCodesListBySetDataTable ListBySetDataTable(Connect aConnect)<br>    {<br>      ListBySetLoad(aConnect);<br>      return ListBySetDataTable();<br>    }<br>  }<br>  [Serializable()]<br>  public class kopaCodesUpdateFromK<br>  {<br>    private kopaCodesUpdateFromKRec mRec;<br>    public kopaCodesUpdateFromKRec Rec { get { return mRec; } set { mRec = value; } }<br>    public void Clear()<br>    {<br>      mRec = new kopaCodesUpdateFromKRec();<br>    }<br>    public kopaCodesUpdateFromK()<br>    {<br>      Clear();<br>    }<br>    public string CommandUpdateFromK<br>    {<br>      // UPDATE kopaCodes <br>      // SET pageId = @P0 <br>      // , description = @P1 <br>      // , disUsed = 0 <br>      // WHERE setId = @P2 <br>      // AND   kopaCode = @P3 <br>      get {return "kopaCodesUpdateFromK";}<br>    }<br>    public void UpdateFromK(Connect aConnect)<br>    {<br>      Cursor wCursor = new Cursor(aConnect);<br>      wCursor.Procedure(CommandUpdateFromK);<br>      wCursor.Parameter(0, mRec.pageId);<br>      wCursor.Parameter(1, mRec.description);<br>      wCursor.Parameter(2, mRec.setId);<br>      wCursor.Parameter(3, mRec.kopaCode);<br>      wCursor.Exec();<br>    }<br>  }<br>  [Serializable()]<br>  public class kopaCodesMarkNotUsed<br>  {<br>    private kopaCodesMarkNotUsedRec mRec;<br>    public kopaCodesMarkNotUsedRec Rec { get { return mRec; } set { mRec = value; } }<br>    public void Clear()<br>    {<br>      mRec = new kopaCodesMarkNotUsedRec();<br>    }<br>    public kopaCodesMarkNotUsed()<br>    {<br>      Clear();<br>    }<br>    public string CommandMarkNotUsed<br>    {<br>      // UPDATE kopaCodes <br>      // SET disUsed = 1 <br>      // WHERE setId = @P0 <br>      // AND   kopaCode = @P1 <br>      get {return "kopaCodesMarkNotUsed";}<br>    }<br>    public void MarkNotUsed(Connect aConnect)<br>    {<br>      Cursor wCursor = new Cursor(aConnect);<br>      wCursor.Procedure(CommandMarkNotUsed);<br>      wCursor.Parameter(0, mRec.setId);<br>      wCursor.Parameter(1, mRec.kopaCode);<br>      wCursor.Exec();<br>    }<br>  }<br>  [Serializable()]<br>  public class kopaCodesUpdateSelect<br>  {<br>    private kopaCodesUpdateSelectRec mRec;<br>    public kopaCodesUpdateSelectRec Rec { get { return mRec; } set { mRec = value; } }<br>    public void Clear()<br>    {<br>      mRec = new kopaCodesUpdateSelectRec();<br>    }<br>    public kopaCodesUpdateSelect()<br>    {<br>      Clear();<br>    }<br>    public string CommandUpdateSelect<br>    {<br>      // UPDATE kopaCodes <br>      // SET ecoCode  = @P0 <br>      // , selected = @P1 <br>      // , strategy = @P2 <br>      // WHERE setId  = @P3 <br>      // AND kopaCode = @P4 <br>      get {return "kopaCodesUpdateSelect";}<br>    }<br>    public void UpdateSelect(Connect aConnect)<br>    {<br>      Cursor wCursor = new Cursor(aConnect);<br>      wCursor.Procedure(CommandUpdateSelect);<br>      wCursor.Parameter(0, mRec.ecoCode);<br>      wCursor.Parameter(1, mRec.selected);<br>      wCursor.Parameter(2, mRec.strategy);<br>      wCursor.Parameter(3, mRec.setId);<br>      wCursor.Parameter(4, mRec.kopaCode);<br>      wCursor.Exec();<br>    }<br>  }<br>  [Serializable()]<br>  public class kopaCodesBuildSetList<br>  {<br>    private kopaCodesBuildSetListRec mRec;<br>    public kopaCodesBuildSetListRec Rec { get { return mRec; } set { mRec = value; } }<br>    private ArrayList mList;<br>    public int Count { get { return mList.Count; } }<br>    public Cursor mCursor;<br>    public kopaCodesBuildSetListRec this[int i]<br>    {<br>      get<br>      {<br>        if (i &lt; mList.Count)<br>          return (kopaCodesBuildSetListRec)mList[i];<br>        return null;<br>      }<br>      set<br>      {<br>        if (i &lt; mList.Count)<br>          mList.RemoveAt(i);<br>        mList.Insert(i, value);<br>      }<br>    }<br>    public void Clear()<br>    {<br>      mList = new ArrayList();<br>      mRec = new kopaCodesBuildSetListRec();<br>    }<br>    public kopaCodesBuildSetList()<br>    {<br>      Clear();<br>    }<br>    public string CommandBuildSetList<br>    {<br>      // SELECT c.ecoCode, c.selected, c.strategy, s.dir, c.setId, c.kopaCode, c.period, s.lastNo <br>      // FROM kopaCodes c, KopaSets s <br>      // WHERE c.selected &gt; 0 <br>      // AND   (s.setId = @P0 or @P1 = '**') <br>      // AND   c.setId = s.SetId <br>      get {return "kopaCodesBuildSetList";}<br>    }<br>    public void BuildSetList(Connect aConnect)<br>    {<br>      mCursor = new Cursor(aConnect);<br>      mCursor.Procedure(CommandBuildSetList);<br>      mCursor.Parameter(0, mRec.setId);<br>      mCursor.Parameter(1, mRec.setId);<br>      mCursor.Run();<br>    }<br>    public bool BuildSetListFetch()<br>    {<br>      bool wResult = (mCursor.HasReader() &amp;&amp; mCursor.Read());<br>      if (wResult == true)<br>      {<br>        mRec.ecoCode = mCursor.GetString(0);<br>        mRec.selected = mCursor.GetInt(1);<br>        mRec.strategy = mCursor.GetInt(2);<br>        mRec.dir = mCursor.GetString(3);<br>        mRec.setId = mCursor.GetString(4);<br>        mRec.kopaCode = mCursor.GetString(5);<br>        mRec.period = mCursor.GetString(6);<br>        mRec.lastNo = mCursor.GetInt(7);<br>      }<br>      else if (mCursor.HasReader())<br>        mCursor.Close();<br>      return wResult;<br>    }<br>    public void BuildSetListLoad(Connect aConnect)<br>    {<br>      BuildSetList(aConnect);<br>      while (BuildSetListFetch())<br>      {<br>        mList.Add(mRec);<br>        mRec = new kopaCodesBuildSetListRec();<br>      }<br>    }<br>    public ArrayList Loaded { get { return mList; } }<br>    public class BuildSetListOrd<br>    {<br>      public const int setId = 0;<br>      public const int ecoCode = 1;<br>      public const int selected = 2;<br>      public const int strategy = 3;<br>      public const int dir = 4;<br>      public const int kopaCode = 5;<br>      public const int period = 6;<br>      public const int lastNo = 7;<br>      public static string ToString(int ordinal)<br>      {<br>        switch (ordinal)<br>        {<br>        case 0: return "setId";<br>        case 1: return "ecoCode";<br>        case 2: return "selected";<br>        case 3: return "strategy";<br>        case 4: return "dir";<br>        case 5: return "kopaCode";<br>        case 6: return "period";<br>        case 7: return "lastNo";<br>        }<br>        return "";<br>      }<br>    }<br>    public kopaCodesBuildSetListDataTable BuildSetListDataTable()<br>    {<br>      kopaCodesBuildSetListDataTable wResult = new kopaCodesBuildSetListDataTable(mList);<br>      return wResult;<br>    }<br>    public kopaCodesBuildSetListDataTable BuildSetListDataTable(Connect aConnect)<br>    {<br>      BuildSetListLoad(aConnect);<br>      return BuildSetListDataTable();<br>    }<br>  }<br>  [Serializable()]<br>  public class kopaCodesChangeAlias<br>  {<br>    private kopaCodesChangeAliasRec mRec;<br>    public kopaCodesChangeAliasRec Rec { get { return mRec; } set { mRec = value; } }<br>    public void Clear()<br>    {<br>      mRec = new kopaCodesChangeAliasRec();<br>    }<br>    public kopaCodesChangeAlias()<br>    {<br>      Clear();<br>    }<br>    public string CommandChangeAlias<br>    {<br>      // update kopaCodes set ecoCode = @P0 <br>      // where  setId = @P1 <br>      // and    kopaCode = @P2 <br>      get {return "kopaCodesChangeAlias";}<br>    }<br>    public void ChangeAlias(Connect aConnect)<br>    {<br>      Cursor wCursor = new Cursor(aConnect);<br>      wCursor.Procedure(CommandChangeAlias);<br>      wCursor.Parameter(0, mRec.ecoCode);<br>      wCursor.Parameter(1, mRec.setId);<br>      wCursor.Parameter(2, mRec.kopaCode);<br>      wCursor.Exec();<br>    }<br>  }<br>}<br></pre>
</body>
</html>
