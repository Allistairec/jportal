<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>MsSQL CSharp Example Stored Procs</title>
</head>
<body>
<h1>MsSQL CSharp Example Stored Procs</h1>
<pre>use AnyDB<br><br>if exists (select * from sysobjects where id = object_id('dbo.kopaCodesInsert') and sysstat &amp; 0xf = 4)<br>drop procedure dbo.kopaCodesInsert<br>GO<br><br>CREATE PROCEDURE dbo.kopaCodesInsert<br>( @P0 varchar(24) -- ecoCode<br>, @P1 varchar(2) -- setId<br>, @P2 varchar(24) -- kopaCode<br>, @P3 varchar(24) -- pageId<br>, @P4 varchar(1) -- period<br>, @P5 varchar(250) -- description<br>, @P6 integer -- selected<br>, @P7 integer -- strategy<br>, @P8 integer -- disUsed<br>, @P9 varchar(16) -- updBy<br>, @P10 datetime -- updWhen<br>)<br>AS<br>insert into kopaCodes<br>( ecoCode<br>, setId<br>, kopaCode<br>, pageId<br>, period<br>, description<br>, selected<br>, strategy<br>, disUsed<br>, updBy<br>, updWhen<br>) <br>values<br> (@P0<br>, @P1<br>, @P2<br>, @P3<br>, @P4<br>, @P5<br>, @P6<br>, @P7<br>, @P8<br>, @P9<br>, @P10<br>)<br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.kopaCodesSelectOne') and sysstat &amp; 0xf = 4)<br>drop procedure dbo.kopaCodesSelectOne<br>GO<br><br>CREATE PROCEDURE dbo.kopaCodesSelectOne<br>( @P0 varchar(24) -- ecoCode<br>)<br>AS<br>select<br>  setId<br>, kopaCode<br>, pageId<br>, period<br>, description<br>, selected<br>, strategy<br>, disUsed<br>, updBy<br>, updWhen<br> from kopaCodes<br> where ecoCode = @P0<br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.kopaCodesUpdate') and sysstat &amp; 0xf = 4)<br>drop procedure dbo.kopaCodesUpdate<br>GO<br><br>CREATE PROCEDURE dbo.kopaCodesUpdate<br>( @P0 varchar(2) -- setId<br>, @P1 varchar(24) -- kopaCode<br>, @P2 varchar(24) -- pageId<br>, @P3 varchar(1) -- period<br>, @P4 varchar(250) -- description<br>, @P5 integer -- selected<br>, @P6 integer -- strategy<br>, @P7 integer -- disUsed<br>, @P8 varchar(16) -- updBy<br>, @P9 datetime -- updWhen<br>, @P10 varchar(24) -- ecoCode<br>)<br>AS<br>update kopaCodes<br> set<br>  setId = @P0<br>, kopaCode = @P1<br>, pageId = @P2<br>, period = @P3<br>, description = @P4<br>, selected = @P5<br>, strategy = @P6<br>, disUsed = @P7<br>, updBy = @P8<br>, updWhen = @P9<br> where ecoCode = @P10<br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.kopaCodesSelectAll') and sysstat &amp; 0xf = 4)<br>drop procedure dbo.kopaCodesSelectAll<br>GO<br><br>CREATE PROCEDURE dbo.kopaCodesSelectAll<br>AS<br>select<br>  ecoCode<br>, setId<br>, kopaCode<br>, pageId<br>, period<br>, description<br>, selected<br>, strategy<br>, disUsed<br>, updBy<br>, updWhen<br> from kopaCodes<br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.kopaCodesDeleteOne') and sysstat &amp; 0xf = 4)<br>drop procedure dbo.kopaCodesDeleteOne<br>GO<br><br>CREATE PROCEDURE dbo.kopaCodesDeleteOne<br>( @P0 varchar(24) -- ecoCode<br>)<br>AS<br>delete from kopaCodes<br> where ecoCode = @P0<br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.kopaCodesList') and sysstat &amp; 0xf = 4)<br>drop procedure dbo.kopaCodesList<br>GO<br><br>CREATE PROCEDURE dbo.kopaCodesList<br>( @P0 varchar(2) -- setId<br>, @P1 varchar(1) -- period<br>)<br>AS<br>SELECT ecoCode, pageId, kopaCode, period, description, disUsed <br>FROM kopaCodes <br>WHERE setId = @P0 <br>AND   period = @P1 <br>ORDER BY kopaCode <br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.kopaCodesListBySet') and sysstat &amp; 0xf = 4)<br>drop procedure dbo.kopaCodesListBySet<br>GO<br><br>CREATE PROCEDURE dbo.kopaCodesListBySet<br>( @P0 varchar(2) -- setId<br>, @P1 varchar(24) -- pageId<br>, @P2 varchar(1) -- period<br>)<br>AS<br>SELECT ecoCode, selected, strategy, disUsed, description, setId, kopaCode, pageId, period, updBy, updWhen <br>FROM kopaCodes <br>WHERE setId = @P0 <br>AND  pageId = @P1 <br>AND  period = @P2 <br>ORDER BY ecoCode <br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.kopaCodesUpdateFromK') and sysstat &amp; 0xf = 4)<br>drop procedure dbo.kopaCodesUpdateFromK<br>GO<br><br>CREATE PROCEDURE dbo.kopaCodesUpdateFromK<br>( @P0 varchar(24) -- pageId<br>, @P1 varchar(250) -- description<br>, @P2 varchar(2) -- setId<br>, @P3 varchar(24) -- kopaCode<br>)<br>AS<br>UPDATE kopaCodes <br>SET pageId = @P0 <br>, description = @P1 <br>, disUsed = 0 <br>WHERE setId = @P2 <br>AND   kopaCode = @P3 <br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.kopaCodesMarkNotUsed') and sysstat &amp; 0xf = 4)<br>drop procedure dbo.kopaCodesMarkNotUsed<br>GO<br><br>CREATE PROCEDURE dbo.kopaCodesMarkNotUsed<br>( @P0 varchar(2) -- setId<br>, @P1 varchar(24) -- kopaCode<br>)<br>AS<br>UPDATE kopaCodes <br>SET disUsed = 1 <br>WHERE setId = @P0 <br>AND   kopaCode = @P1 <br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.kopaCodesUpdateSelect') and sysstat &amp; 0xf = 4)<br>drop procedure dbo.kopaCodesUpdateSelect<br>GO<br><br>CREATE PROCEDURE dbo.kopaCodesUpdateSelect<br>( @P0 varchar(24) -- ecoCode<br>, @P1 integer -- selected<br>, @P2 integer -- strategy<br>, @P3 varchar(2) -- setId<br>, @P4 varchar(24) -- kopaCode<br>)<br>AS<br>UPDATE kopaCodes <br>SET ecoCode  = @P0 <br>, selected = @P1 <br>, strategy = @P2 <br>WHERE setId  = @P3 <br>AND kopaCode = @P4 <br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.kopaCodesBuildSetList') and sysstat &amp; 0xf = 4)<br>drop procedure dbo.kopaCodesBuildSetList<br>GO<br><br>CREATE PROCEDURE dbo.kopaCodesBuildSetList<br>( @P0 varchar(2) -- setId<br>, @P1 varchar(2) -- setId<br>)<br>AS<br>SELECT c.ecoCode, c.selected, c.strategy, s.dir, c.setId, c.kopaCode, c.period, s.lastNo <br>FROM kopaCodes c, KopaSets s <br>WHERE c.selected &gt; 0 <br>AND   (s.setId = @P0 or @P1 = '**') <br>AND   c.setId = s.SetId <br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.kopaCodesChangeAlias') and sysstat &amp; 0xf = 4)<br>drop procedure dbo.kopaCodesChangeAlias<br>GO<br><br>CREATE PROCEDURE dbo.kopaCodesChangeAlias<br>( @P0 varchar(24) -- ecoCode<br>, @P1 varchar(2) -- setId<br>, @P2 varchar(24) -- kopaCode<br>)<br>AS<br>update kopaCodes set ecoCode = @P0 <br>where  setId = @P1 <br>and    kopaCode = @P2 <br>GO<br><br></pre>
</body>
</html>
